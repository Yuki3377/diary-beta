<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>写メ日記AI</title>

<style>
:root{
  --bg:#fff4f8;
  --card:#ffffff;
  --accent:#ff5fa2;
  --accent-soft:#ffc2da;
  --text:#444;
  --radius:18px;
}

body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
  background:var(--bg);
  color:var(--text);
}

.wrapper{
  max-width:520px;
  margin:40px auto;
  padding:20px;
}

h1{
  text-align:center;
  margin-bottom:20px;
}

/* ===== プロフィールバー ===== */

.profile-bar{
  background:white;
  padding:12px 16px;
  border-radius:30px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:20px;
  box-shadow:0 6px 18px rgba(255,95,162,0.1);
  font-size:12px;
}

.profile-info{
  opacity:0.8;
}

.edit-btn{
  background:var(--accent);
  color:white;
  border:none;
  border-radius:20px;
  padding:6px 12px;
  font-size:11px;
  cursor:pointer;
}

/* ===== カード ===== */

.card{
  background:var(--card);
  padding:20px;
  border-radius:var(--radius);
  margin-bottom:18px;
  box-shadow:0 8px 20px rgba(255,95,162,0.08);
}

label{
  font-size:13px;
  font-weight:600;
}

select,input{
  width:100%;
  padding:14px;
  border-radius:14px;
  border:1px solid #eee;
  margin-top:8px;
}

button.primary{
  width:100%;
  padding:15px;
  border:none;
  border-radius:25px;
  background:linear-gradient(135deg,#ff5fa2,#ff85b3);
  color:white;
  font-size:15px;
  cursor:pointer;
}

.result{
  margin-top:25px;
  padding:22px;
  background:var(--accent-soft);
  border-radius:var(--radius);
  white-space:pre-wrap;
  display:none;
}

/* ===== モーダル ===== */

.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.3);
  display:none;
  justify-content:center;
  align-items:center;
}

.modal-content{
  background:white;
  width:90%;
  max-width:400px;
  padding:20px;
  border-radius:20px;
}

</style>
</head>
<body>

<div class="wrapper">
<h1>写メ日記 AI</h1>

<div class="profile-bar">
  <div class="profile-info" id="profileDisplay">プロフィール未設定</div>
  <button class="edit-btn" onclick="openModal()">編集</button>
</div>

<div class="card">
  <label>今日の感情</label>
  <select id="mood">
    <option>甘えたい</option>
    <option>ムラムラしている</option>
    <option>寂しい</option>
    <option>ご機嫌</option>
  </select>
</div>

<div class="card">
  <label>題名</label>
  <input id="title">
</div>

<button class="primary" onclick="generate()">生成する</button>

<div class="result" id="result"></div>

</div>

<!-- ===== プロフィールモーダル ===== -->

<div class="modal" id="profileModal">
  <div class="modal-content">
    <h3>プロフィール編集</h3>

    <label>名前</label>
    <input id="name">

    <label>自分の呼び方</label>
    <input id="selfCall">

    <label>お客様の呼び方</label>
    <input id="customerCall">

    <label>年齢</label>
    <select id="age">
      <option>20代</option>
      <option>30代</option>
      <option>40代</option>
      <option>50代</option>
    </select>

    <label>キャラクター</label>
    <select id="character">
      <option>妹系</option>
      <option>小悪魔系</option>
      <option>清楚系</option>
      <option>お姉さん系</option>
      <option>人妻系</option>
    </select>

    <button class="primary" onclick="saveProfile()">保存する</button>
  </div>
</div>

<script>

/* ===== プロフィール表示更新 ===== */

function updateProfileBar(){
  const saved=localStorage.getItem("profile");
  const display=document.getElementById("profileDisplay");

  if(!saved){
    display.innerText="プロフィール未設定";
    return;
  }

  const p=JSON.parse(saved);
  display.innerText=
`${p.name}｜${p.age}｜${p.character}`;
}

/* ===== モーダル ===== */

function openModal(){
  document.getElementById("profileModal").style.display="flex";
}

function saveProfile(){
  const profile={
    name:document.getElementById("name").value,
    selfCall:document.getElementById("selfCall").value,
    customerCall:document.getElementById("customerCall").value,
    age:document.getElementById("age").value,
    character:document.getElementById("character").value
  };

  localStorage.setItem("profile",JSON.stringify(profile));
  document.getElementById("profileModal").style.display="none";
  updateProfileBar();
}

/* ===== 生成 ===== */

function generate(){

  const saved=localStorage.getItem("profile");
  if(!saved){
    alert("プロフィールを設定してください");
    return;
  }

  const p=JSON.parse(saved);
  const mood=document.getElementById("mood").value;
  const title=document.getElementById("title").value;

  const text=
`${title}

${p.selfCall}、今日は${mood}気分。

${p.customerCall}、どうする？`;

  const result=document.getElementById("result");
  result.innerText=text;
  result.style.display="block";
}

window.onload=updateProfileBar;

</script>

</body>
</html>
