<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>売れるキャラを作る</title>

<style>
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, "Noto Sans JP", sans-serif;
  background: #ffffff;
}

.container {
  padding: 20px;
  animation: fadeUp 0.3s ease;
}

.title {
  font-size: 22px;
  font-weight: 700;
  margin-bottom: 6px;
}

.subtitle {
  font-size: 14px;
  color: #666;
  margin-bottom: 20px;
}

h2 {
  font-size: 16px;
  margin-top: 30px;
  margin-bottom: 10px;
}

input {
  width: 100%;
  padding: 12px;
  margin-bottom: 10px;
  font-size: 16px;
  border: 1px solid #ddd;
  border-radius: 10px;
  box-sizing: border-box;
}

.button-group {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
}

.btn {
  padding: 10px 16px;
  border-radius: 20px;
  border: 1px solid #ccc;
  cursor: pointer;
  font-size: 14px;
  transition: all 0.15s ease;
}

.btn.active {
  background: #111;
  color: #fff;
  border-color: #111;
}

.btn:active {
  transform: scale(0.95);
}

.save-toast {
  position: fixed;
  top: 15px;
  left: 50%;
  transform: translateX(-50%);
  background: #111;
  color: #fff;
  padding: 8px 14px;
  border-radius: 20px;
  font-size: 13px;
  opacity: 0;
  transition: opacity 0.3s ease;
}

@keyframes fadeUp {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
</style>
</head>

<body>

<div class="container">

<h1 class="title">売れるキャラを作る</h1>
<p class="subtitle">あなたの魅力をAIに覚えさせましょう</p>

<h2>基本情報</h2>
<input type="text" id="name" placeholder="源氏名">
<input type="text" id="selfCall" placeholder="自分の呼び方（例：私・あたし）">
<input type="text" id="customerCall" placeholder="お客様の呼び方（例：あなた・○○さん）">

<h2>年齢</h2>
<div class="button-group" id="ageGroup">
  <div class="btn">20代</div>
  <div class="btn">30代</div>
  <div class="btn">40代</div>
  <div class="btn">50代</div>
</div>

<h2>キャラクター</h2>
<div class="button-group" id="charGroup">
  <div class="btn">妹系</div>
  <div class="btn">小悪魔系</div>
  <div class="btn">清楚系</div>
  <div class="btn">お姉さん系</div>
  <div class="btn">人妻系</div>
</div>

<h2>個性（最大3つ）</h2>
<div class="button-group" id="traitGroup">
  <div class="btn">S気質</div>
  <div class="btn">M気質</div>
  <div class="btn">甘え体質</div>
  <div class="btn">寂しがり</div>
  <div class="btn">痴女</div>
  <div class="btn">巨乳</div>
  <div class="btn">グラマー</div>
  <div class="btn">大人の色気</div>
</div>

</div>

<div id="saveToast" class="save-toast">✓ 保存しました</div>

<script>

window.onload = function () {
  const profile = JSON.parse(localStorage.getItem("profile")) || {};
  
  name.value = profile.name || "";
  selfCall.value = profile.selfCall || "";
  customerCall.value = profile.customerCall || "";

  restoreSingle("ageGroup", profile.age);
  restoreSingle("charGroup", profile.character);
  restoreMulti("traitGroup", profile.traits || []);
};

function saveProfile() {
  const profile = {
    name: name.value,
    selfCall: selfCall.value,
    customerCall: customerCall.value,
    age: getSingle("ageGroup"),
    character: getSingle("charGroup"),
    traits: getMulti("traitGroup")
  };
  localStorage.setItem("profile", JSON.stringify(profile));
  showToast();
}

document.querySelectorAll("input").forEach(input => {
  input.addEventListener("input", saveProfile);
});

function setupSingle(groupId) {
  const group = document.getElementById(groupId);
  group.querySelectorAll(".btn").forEach(btn => {
    btn.onclick = () => {
      group.querySelectorAll(".btn").forEach(b => b.classList.remove("active"));
      btn.classList.add("active");
      saveProfile();
    };
  });
}

function setupMulti(groupId, max) {
  const group = document.getElementById(groupId);
  group.querySelectorAll(".btn").forEach(btn => {
    btn.onclick = () => {
      const active = group.querySelectorAll(".active");
      if (!btn.classList.contains("active") && active.length >= max) {
        alert("最大3つまでです");
        return;
      }
      btn.classList.toggle("active");
      saveProfile();
    };
  });
}

function getSingle(groupId) {
  const active = document.querySelector(`#${groupId} .active`);
  return active ? active.textContent : "";
}

function getMulti(groupId) {
  return Array.from(document.querySelectorAll(`#${groupId} .active`))
              .map(b => b.textContent);
}

function restoreSingle(groupId, value) {
  if (!value) return;
  document.querySelectorAll(`#${groupId} .btn`).forEach(btn => {
    if (btn.textContent === value) btn.classList.add("active");
  });
}

function restoreMulti(groupId, values) {
  document.querySelectorAll(`#${groupId} .btn`).forEach(btn => {
    if (values.includes(btn.textContent)) btn.classList.add("active");
  });
}

function showToast() {
  const toast = document.getElementById("saveToast");
  toast.style.opacity = "1";
  setTimeout(() => {
    toast.style.opacity = "0";
  }, 1000);
}

setupSingle("ageGroup");
setupSingle("charGroup");
setupMulti("traitGroup", 3);

</script>

</body>
</html>
